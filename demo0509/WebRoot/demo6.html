<!DOCTYPE html>
<html>
<head>
	
	<meta http-equiv="pragma" content="no-cache">
	<meta http-equiv="cache-control" content="no-cache">
	<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
	<meta http-equiv="x-dns-prefetch-control" content="on" />
	<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=0" />
	<meta name="apple-mobile-web-app-capable" content="yes" />
	<meta name="apple-mobile-web-app-status-bar-style" content="black" />
	<meta name="format-detection" content="telephone=no, email=no" />
	<meta name="x5-orientation" content="portrait">
	<meta name="x5-fullscreen" content="true">
	<meta name="x5-page-mode" content="app">
	<meta name="msapplication-tap-highlight" content="no">


	<title>demo 范例</title>
	<script type="text/javascript" src='js/require.min.js'></script>
	<script type="text/javascript" src='js/jquery-1.10.2.min.js'></script>
	<script type="text/javascript" debug='true' src='js/utils.js'></script>
	
	<link rel='stylesheet' href='css/common.css'></link>
	
	<!-- 
	<script type='x' charset="utf-8" src="http://map.qq.com/api/js?v=2.exp"></script>
	  <script type='text/javascript' src='http://res.wx.qq.com/open/js/jweixin-1.0.0.js'></script>
 -->
</head>

<style type="text/css" id='style'>
	
	body{ background:black; }
	.gbox{ background : wheat ; }
	.img1{ background:url('./img/imgs/1.jpg');background-size:100% 100%; }
	.img2{ background:url('./img/imgs/1.jpg'); }
	.box1{ width:100%;height:80px;margin-bottom:20px;background:#fff;display:block; }
	.box1:last-of-type { margin-bottom:0px;}
	.btn{ width:120px;line-height:50px;background:green;border-radius:10px;margin:auto;color:white;text-align:center;}
</style>

<script type='x' id='baseTmpl'>
	<div class='pr oh full' id='mainWarp'>
		<div >
			<div class=' pr fullw' id='slider' >
				<img style='width:100%;' title="标题1" src='./img/imgs/1.jpg'></img>
				<a href='www.baidu.com'><img style='width:100%;' title="标题2"  src='./img/imgs/2.jpg'></img></a>
				<img style='width:100%;' title="标题3" src='./img/imgs/3.jpg'></img>
				<img style='width:100%;' title="标题4" src='./img/imgs/4.jpg'></img>
			</div>
			<div style='width:100%;padding:30px 0;background:wheat;'>
				<div class='pr ma' style='width:320px;height:80px;margin-top:20px;'><input type='file' class='full'></input></div>
				<div class='btn btnTp' as='tr2'>发送</div>
			</div>
			{{each ut.getArray(10)}}
				<span class='box1'>@{@last}</span>
			{{/each}}
			<div class='tac fs24 c-white loaderTp' style='line-height:60px;'>加载更多...</div>
		</div>
	</div>
</script>

	<script type="text/javascript">
		
		
		$(function(){
			ut.client.box(640);
			$.tmpl('baseTmpl').appendTo(body);
			var scroll = ut.iScroll('#mainWarp');
			
			var f = ut.flux($('#slider'),{
				captions: true,
				pagination: false,
				transitions : ['dissolve'],
				animDelay : '1600ms' ,
//				bulletStyle : {background:'darkred'},
				bulletActiveStyle : {background:'yellow'},
				height:380
			});
			
			$(document).on('change','input',function(){
				var file = this.files[0];
				file.name = "yinwen.text" ;
				console.log(file);
				var f  = $.extend(true,{},file) ;
				alert(JSON.stringify(f));
				
//				var files = Array.prototype.slice.call(this.files);
//				alert(JSON.stringify(files));
//				files.forEach(function(file,i){
//					var reader = new FileReader();
//			        reader.onload = function () {
//			            var result = this.result;
//			            upload(result, file.type);
//			        };
//			        reader.readAsDataURL(file);
//				});
			});
			
			function upload(basestr, type){
			    var xhr = new XMLHttpRequest();
			    var text = window.atob(basestr.split(",")[1]);
//				alert(text);
			    var buffer = new Uint8Array(text.length);
			    var pecent = 0;
			    for (var i = 0; i < text.length; i++) {
			        buffer[i] = text.charCodeAt(i);
			    }
			
//			    xhr.open('post', '/uploadtest?filetype=' + type.split('/')[1]);
//			    xhr.setRequestHeader('Content-Type', 'application/octet-stream');
//			    xhr.onreadystatechange = function () {
//			        if (xhr.readyState == 4 && xhr.status == 200) {
//			            var jsonData = JSON.parse(xhr.responseText);
//			            console.log(jsonData);
//			        }
//			    };
//			    xhr.send(buffer.buffer); // 以ArrayBuffer的方式上传图片
			}
			

		}) ;


	</script>
</html>





